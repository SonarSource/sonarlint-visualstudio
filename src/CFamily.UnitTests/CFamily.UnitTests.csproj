<Project Sdk="Microsoft.NET.Sdk">

  <Import Project="..\SonarLint.Test.props" />
  
  <PropertyGroup>
    <ProjectGuid>{30e1ff8f-94ba-4a39-a737-8ffd7b4a0cd3}</ProjectGuid>
    <RootNamespace>SonarLint.VisualStudio.CFamily.UnitTests</RootNamespace>
    <AssemblyName>SonarLint.VisualStudio.CFamily.UnitTests</AssemblyName>
  </PropertyGroup>

  <ItemGroup Label="Test framework">
    <PackageReference Include="Microsoft.NET.Test.Sdk" Version="16.5.0" />
    <PackageReference Include="MSTest.TestAdapter" Version="1.4.0" />
    <PackageReference Include="MSTest.TestFramework" Version="1.4.0" />
    <PackageReference Include="Moq" Version="4.14.5" />
    <PackageReference Include="FluentAssertions" Version="5.9.0" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\CFamily\CFamily.csproj" />
    <ProjectReference Include="..\TestInfrastructure\TestInfrastructure.csproj" />
  </ItemGroup>

  <ItemGroup>
    <Reference Include="System.ComponentModel.Composition" />
  </ItemGroup>

  <ItemGroup>
    <None Update="Rules\TestResources\**\*.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <ItemGroup Label="HACK to make the C++ rule loader tests work">
    <!-- We need all of the json files in the lib subfolder to be copied under the test assembly folder.
         The files are marked as content files in the Integration project, but since this project was
         converted to be an SDK-style project the files are being deleted when before the tests are run,
         causing them to fail. 
    -->
    <Content Include="..\Integration.Vsix\lib\**\*">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <Link>lib\%(Filename)%(Extension)</Link>
    </Content>
  </ItemGroup>

  <ItemGroup>
    <None Update="IntegrationTests\*.txt">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
    <None Update="IntegrationTests\*.json">
      <CopyToOutputDirectory>Always</CopyToOutputDirectory>
    </None>
  </ItemGroup>
  
</Project>
